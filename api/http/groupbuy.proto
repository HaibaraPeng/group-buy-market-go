syntax = "proto3";

package api.http;

import "google/api/annotations.proto";

option go_package = "group-buy-market-go/api/http;v1";

// GroupBuyService HTTP API
service GroupBuyHTTP {
  // MarketTrial handles market trial requests
  rpc MarketTrial(MarketTrialRequest) returns (MarketTrialReply){
    option (google.api.http) = {
      get: "/market/trial"
    };
  };
}

message GetAllActivitiesRequest {}

message GetAllActivitiesReply {
  repeated GroupBuyActivityInfo activities = 1;
}

message GetAllDiscountsRequest {}

message GetAllDiscountsReply {
  repeated GroupBuyDiscountInfo discounts = 1;
}

message GetDiscountByIDRequest {
  int64 id = 1;
}

message GetDiscountByIDReply {
  GroupBuyDiscountInfo discount = 1;
}

message MarketTrialRequest {
  string user_id = 1;
  string goods_id = 2;
  string source = 3;
  string channel = 4;
}

message MarketTrialReply {
  TrialBalanceInfo trial_result = 1;
}

message GroupBuyActivityInfo {
  int64 activity_id = 1;
  string activity_name = 2;
  string source = 3;
  string channel = 4;
  string goods_id = 5;
  GroupBuyDiscountInfo group_buy_discount = 6;
  int32 group_type = 7;
  int32 take_limit_count = 8;
  int32 target = 9;
  int32 valid_time = 10;
  int32 status = 11;
  int64 start_time = 12;
  int64 end_time = 13;
  string tag_id = 14;
  string tag_scope = 15;
}

message GroupBuyDiscountInfo {
  int64 id = 1;
  int32 discount_id = 2;
  string discount_name = 3;
  string discount_desc = 4;
  int32 discount_type = 5;
  string market_plan = 6;
  string market_expr = 7;
  string tag_id = 8;
  int64 create_time = 9;
  int64 update_time = 10;
}

message TrialBalanceInfo {
  string goods_id = 1;
  string goods_name = 2;
  double original_price = 3;
  double deduction_price = 4;
  int32 target_count = 5;
  int64 start_time = 6;
  int64 end_time = 7;
  bool is_visible = 8;
  bool is_enable = 9;
}